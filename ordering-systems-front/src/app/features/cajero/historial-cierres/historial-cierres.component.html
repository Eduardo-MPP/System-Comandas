<app-navbar></app-navbar>

<div class="history-container">
    <div class="history-header">
        <button class="btn-back" (click)="goBack()">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
            Volver
        </button>
        <h1>
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 8v4l3 3"></path>
                <circle cx="12" cy="12" r="10"></circle>
            </svg>
            Historial de Cierres de Caja
        </h1>
        <p>Consulta todos los cierres realizados</p>
    </div>

    <div class="loading-spinner" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>Cargando historial...</p>
    </div>

    <div class="closings-list" *ngIf="!isLoading && closings.length > 0">
        <div class="closing-card" *ngFor="let closing of closings">
            <div class="closing-header">
                <div class="closing-title">
                    <h3>{{ closing.name }}</h3>
                    <p class="closing-date">{{ formatDate(closing.closedAt) }}</p>
                </div>
                <div class="closing-cashier">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                    {{ closing.cashierName }}
                </div>
            </div>

            <div class="closing-body">
                <div class="amount-grid">
                    <div class="amount-item total">
                        <div class="amount-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <div class="amount-content">
                            <span class="amount-label">Total</span>
                            <span class="amount-value">S/ {{ closing.totalAmount.toFixed(2) }}</span>
                        </div>
                    </div>

                    <div class="amount-item efectivo">
                        <div class="amount-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect width="20" height="12" x="2" y="6" rx="2"></rect>
                                <circle cx="12" cy="12" r="2"></circle>
                                <path d="M6 12h.01M18 12h.01"></path>
                            </svg>
                        </div>
                        <div class="amount-content">
                            <span class="amount-label">Efectivo</span>
                            <span class="amount-value">S/ {{ closing.efectivoAmount.toFixed(2) }}</span>
                        </div>
                    </div>

                    <div class="amount-item tarjeta">
                        <div class="amount-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <rect width="20" height="14" x="2" y="5" rx="2"></rect>
                                <line x1="2" y1="10" x2="22" y2="10"></line>
                            </svg>
                        </div>
                        <div class="amount-content">
                            <span class="amount-label">Tarjeta</span>
                            <span class="amount-value">S/ {{ closing.tarjetaAmount.toFixed(2) }}</span>
                        </div>
                    </div>

                    <div class="amount-item transferencia">
                        <div class="amount-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                        </div>
                        <div class="amount-content">
                            <span class="amount-label">Transferencia</span>
                            <span class="amount-value">S/ {{ closing.transferenciaAmount.toFixed(2) }}</span>
                        </div>
                    </div>
                </div>

                <div class="closing-footer">
                    <span class="transactions-count">
                        {{ closing.totalTransactions }} transacciones
                    </span>
                    <button class="btn-details" (click)="viewDetails(closing.id)">
                        Ver Detalles
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                            <polyline points="12 5 19 12 12 19"></polyline>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="empty-state" *ngIf="!isLoading && closings.length === 0">
        <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 8v4l3 3"></path>
            <circle cx="12" cy="12" r="10"></circle>
        </svg>
        <h3>No hay cierres registrados</h3>
        <p>Los cierres aparecerán aquí cuando se realicen</p>
    </div>
</div>
